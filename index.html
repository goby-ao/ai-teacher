<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>生字大冒险 - 完美版</title>
    <!-- 外部字体 -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Lexend:wght@700;800&family=Nunito:wght@700;800;900&display=swap">
    <!-- 外部样式表 -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <div id="bg-canvas-layer"></div>
    <div id="bg-texture-layer"></div>
    <div id="bg-decoration-layer">⭐ 💫 ✨ 🌟 ⭐ 💖 🌈 ⭐ 💫 ✨ 🎈 ⭐ 🌸 💫 ⭐ 🦋 ✨ 💫 🌟 ⭐</div>

    <canvas id="confetti-canvas"></canvas>
    <div id="toast"></div>

    <div class="hud">
        <div class="hud-content">
            <!-- 第一行：标题 -->
            <div class="hud-row-title">
                <div class="hud-title-wrap">
                    <div class="page-title" id="page-title">识字大冒险</div>
                    <div class="btn-pill grade-pill" onpointerdown="GradeSelector.open()">
                        <span>🎒年级</span>
                        <span class="grade-btn-text">年级</span>
                        <span id="current-grade-label" class="grade-btn-value">2下</span>
                    </div>
                </div>
            </div>

            <!-- 第二行：控制按钮 -->
            <div class="hud-row-controls">
                <!-- 左侧组 -->
                <div class="hud-group-left">
                    <div class="btn-pill" onpointerdown="Game.showLevelMap()">
                        <span>🗺️</span>
                        <span id="level-title">第1关</span>
                    </div>
                </div>

                <!-- 右侧组 -->
                <div class="hud-group-right">
                    <!-- 计时器 -->
                    <div class="btn-pill"
                        style="color:#F59E0B; cursor:default; min-width:65px; justify-content:center; gap:4px; border-color: rgba(245, 158, 11, 0.2);"
                        id="timer-display">
                        <span>⏱️</span>
                        <span id="timer-value">0.0</span>
                    </div>

                    <div class="btn-pill" onpointerdown="MistakeBook.open()">
                        <span style="font-size:1rem">📖</span>
                        <span id="mistake-badge"
                            style="background:#FF6B6B; color:#fff; border-radius:8px; padding:0 6px; font-size:0.7rem; display:none;">0</span>
                    </div>
                    <div class="pet-mini" onpointerdown="Dashboard.open()" id="pet-avatar-mini">🥚</div>
                </div>
            </div>
        </div>
    </div>

    <div id="game-container">
        <!-- 首页数据看板 -->
        <div id="home-dashboard">
            <div class="home-welcome">
                <span class="lvl-badge">Lv.<span id="home-lvl-num">1</span></span>
                <span>✨ <span id="welcome-name">小朋友</span>，今天也要加油哦！🎈</span>
            </div>

            <!-- IP 形象英雄区 -->
            <div class="home-hero" onpointerdown="HomeDashboard.interact()">
                <div class="speech-bubble" id="pet-speech">你好呀！</div>
                <div class="pet-mascot" id="pet-home-avatar">🐣</div>
                <div class="pet-shadow" id="pet-home-shadow"></div>
            </div>

            <div class="daily-review-card">
                <div class="daily-review-header">
                    <div class="daily-review-title">今日必练</div>
                    <div class="daily-review-count"><span id="daily-review-done">0</span>/<span
                            id="daily-review-total">0</span></div>
                </div>
                <div class="daily-review-list" id="daily-review-list"></div>
            </div>

            <div class="big-map-btn" onpointerdown="Game.showLevelMap()">
                <div class="btn-icon">🗺️</div>
                <div class="btn-text">
                    <span class="main-txt">开启大冒险</span>
                    <span class="sub-txt">出发吧！去探索更多的文字秘境 ✨</span>
                </div>
            </div>

            <!-- 数据看板折叠区 -->
            <button class="stats-toggle-btn" id="stats-toggle" onclick="HomeDashboard.toggleStats()">
                📊 查看我的成长纪录
            </button>
            <div class="home-stats-grid" id="home-stats-grid">
                <div class="home-stat-card card-pink">
                    <div class="home-stat-icon">📈</div>
                    <div class="home-stat-val" id="h-stat-progress">0%</div>
                    <div class="home-stat-label">冒险进度</div>
                </div>
                <div class="home-stat-card card-blue">
                    <div class="home-stat-icon">📚</div>
                    <div class="home-stat-val" id="h-stat-words">0</div>
                    <div class="home-stat-label">已学字数</div>
                </div>
                <div class="home-stat-card card-yellow">
                    <div class="home-stat-icon">✍️</div>
                    <div class="home-stat-val" id="h-stat-mistakes">0</div>
                    <div class="home-stat-label">错题个数</div>
                </div>
                <div class="home-stat-card card-green">
                    <div class="home-stat-icon">📅</div>
                    <div class="home-stat-val" id="h-stat-days">1</div>
                    <div class="home-stat-label">学习天数</div>
                </div>
                <div class="home-stat-card card-purple">
                    <div class="home-stat-icon">🕒</div>
                    <div class="home-stat-val" id="h-stat-time">0</div>
                    <div class="home-stat-label">挑战总时长(分钟)</div>
                </div>
                <div class="home-stat-card card-orange">
                    <div class="home-stat-icon">🚀</div>
                    <div class="home-stat-val" id="h-stat-speed">-</div>
                    <div class="home-stat-label">最快速度</div>
                </div>
            </div>
        </div>
        <div id="game-board" class="grid-4"></div>
    </div>

    <!-- 弹窗：数据 -->
    <div id="dashboard-modal" class="modal-overlay">
        <div class="card">
            <div class="close-btn" onclick="closeOverlay('dashboard-modal')">✕</div>
            <div class="dashboard-header">
                <div class="pet-big-bg">
                    <div id="pet-avatar-big">🥚</div>
                </div>
                <div style="flex:1">
                    <div style="display:flex; align-items:center; gap:8px;">
                        <div class="pet-name" id="user-nickname-dash">小朋友</div>
                        <span onpointerdown="NicknameSystem.open()"
                            style="cursor:pointer; font-size:1rem; opacity:0.6;">✏️</span>
                    </div>
                    <div class="pet-level-tag">Lv.<span id="pet-level-big">1</span></div>
                    <div class="pet-next">下一级还需 <span id="xp-needed">100</span> 点能量</div>
                </div>
            </div>
            <div class="section-h3">学习数据</div>
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-num" id="stat-days">1</div>
                    <div class="stat-txt">坚持天数</div>
                </div>
                <div class="stat-box">
                    <div class="stat-num" id="stat-words">0</div>
                    <div class="stat-txt">已学生字</div>
                </div>
                <div class="stat-box">
                    <div class="stat-num" id="stat-time">0</div>
                    <div class="stat-txt">学习分钟</div>
                </div>
                <div class="stat-box">
                    <div class="stat-num" id="stat-speed">-</div>
                    <div class="stat-txt">字均用时(秒)</div>
                </div>
            </div>
            <div class="section-h3">成就勋章</div>
            <div class="badge-grid" id="badge-list"></div>
        </div>
    </div>

    <!-- 弹窗：地图 -->
    <div id="map-modal" class="modal-overlay">
        <div class="card map-card">
            <div class="close-btn" onclick="closeOverlay('map-modal')">✕</div>
            <h2 id="map-modal-title" style="text-align:center; color:#333; margin-bottom:20px;">冒险地图</h2>

            <!-- 盲盒挑战卡片 -->
            <div id="blind-box-card" style="margin-bottom: 15px;">
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 16px; padding: 12px 16px; cursor: pointer; transition: all 0.3s ease;"
                    onclick="Game.openBlindBox()">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div id="blind-box-icon" style="font-size: 2.2rem; animation: float 3s ease-in-out infinite;">🎁
                        </div>
                        <div style="flex: 1;">
                            <div style="color: #fff; font-size: 1.1rem; font-weight: 800; margin-bottom: 2px;">神秘盲盒
                            </div>
                            <div style="color: rgba(255,255,255,0.8); font-size: 0.8rem;">随机关卡·限时挑战</div>
                        </div>
                        <div style="text-align: right;">
                            <div
                                style="background: rgba(255,255,255,0.2); padding: 2px 8px; border-radius: 12px; font-size: 0.75rem; color: #fff; margin-bottom: 4px;">
                                <span id="bb-remain-count">15</span>/<span id="bb-total-count">15</span>
                            </div>
                            <div
                                style="background: rgba(255,255,255,0.9); color: #667eea; padding: 4px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 800;">
                                开启
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 随机复盘挑战卡片 -->
            <div id="replay-random-card" style="margin-bottom: 15px;">
                <div style="background: linear-gradient(135deg, #FF9A9E 0%, #FAD0C4 100%); border-radius: 16px; padding: 12px 16px; cursor: pointer; transition: all 0.3s ease;"
                    onclick="Game.openReplayRoulette()">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div style="font-size: 2rem;">🎯</div>
                        <div style="flex: 1;">
                            <div style="color: #fff; font-size: 1.05rem; font-weight: 800; margin-bottom: 2px;">随机复盘
                            </div>
                            <div style="color: rgba(255,255,255,0.85); font-size: 0.8rem;">已通关关卡·冲破纪录</div>
                        </div>
                        <div style="text-align: right;">
                            <div
                                style="background: rgba(255,255,255,0.9); color: #FF6B9D; padding: 4px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 800;">
                                开始
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 拼音雨挑战卡片 -->
            <div id="pinyin-rain-card" style="margin-bottom: 15px;">
                <div style="background: linear-gradient(135deg, #4FACFE 0%, #00F2FE 100%); border-radius: 16px; padding: 12px 16px; cursor: pointer; transition: all 0.3s ease;"
                    onclick="Game.openPinyinRain()">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div style="font-size: 2rem;">🌧️</div>
                        <div style="flex: 1;">
                            <div style="color: #fff; font-size: 1.05rem; font-weight: 800; margin-bottom: 2px;">拼音雨
                            </div>
                            <div style="color: rgba(255,255,255,0.85); font-size: 0.8rem;">听音识字·限时反应</div>
                        </div>
                        <div style="text-align: right;">
                            <div
                                style="background: rgba(255,255,255,0.2); padding: 2px 8px; border-radius: 12px; font-size: 0.75rem; color: #fff; margin-bottom: 4px;">
                                <span id="pr-remain-count">15</span>/<span id="pr-total-count">15</span>
                            </div>
                            <div id="pr-action-pill"
                                style="background: rgba(255,255,255,0.9); color: #0099FF; padding: 4px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: 800;">
                                开始
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="level-map" style="display:grid; grid-template-columns:repeat(4,1fr); gap:12px;"></div>
        </div>
    </div>

    <!-- 弹窗：错题本 -->
    <div id="book-modal" class="modal-overlay">
        <div class="card" style="height:80%; display:flex; flex-direction:column; padding-bottom:10px;">
            <div class="close-btn" onclick="closeOverlay('book-modal')">✕</div>
            <h2 id="book-modal-title" style="margin-bottom:15px; flex-shrink:0; text-align:center; color:#333;">错题本</h2>

            <!-- Tabs -->
            <div style="display:flex; gap:10px; margin-bottom:15px; flex-shrink:0;">
                <div class="btn-pill book-tab" data-mode="current" onclick="MistakeBook.switchMode('current')"
                    style="flex:1; justify-content:center; padding:10px;">📝 待复习</div>
                <div class="btn-pill book-tab" data-mode="history" onclick="MistakeBook.switchMode('history')"
                    style="flex:1; justify-content:center; padding:10px;">📜 历史记录</div>
            </div>

            <div id="mistake-list"
                style="flex:1; overflow-y:auto; display:grid; grid-template-columns:repeat(3, 1fr); gap:10px; align-content:start;">
            </div>
            <div id="book-empty-msg"
                style="margin:auto; color:#999; text-align:center; display:none; flex-shrink:0; padding:20px;">
                <div style="font-size:3rem; margin-bottom:10px;">🌟</div>
                太棒了！当前没有错题哦～
            </div>
        </div>
    </div>

    <!-- 弹窗：详情 -->
    <div id="detail-modal" class="modal-overlay">
        <div class="card">
            <div class="close-btn" onclick="closeOverlay('detail-modal')">✕</div>
            <div style="display:flex; align-items:center; gap:20px; margin-bottom:25px;">
                <div id="card-char"
                    style="font-size:4rem; color:#FF6B6B; background:#FFF0F3; width:80px; height:80px; display:flex; align-items:center; justify-content:center; border-radius:20px;">
                </div>
                <div>
                    <div style="font-size:0.8rem; color:#aaa; font-family:'Nunito'; font-weight:800;">PINYIN</div>
                    <div style="display:flex; align-items:center;">
                        <div id="card-pinyin"
                            style="font-size:1.8rem; font-weight:bold; color:#333; font-family:'Nunito'"></div>
                        <div class="read-btn" onclick="AudioSys.speak(document.getElementById('card-char').innerText)">
                            🔊</div>
                    </div>
                    <div class="detail-audio">
                        <button class="detail-audio-btn record" id="detail-record-btn">🎤 录音</button>
                        <button class="detail-audio-btn play disabled" id="detail-play-btn">🔊 播放</button>
                        <span class="detail-audio-timer" id="detail-record-timer">3.0s</span>
                    </div>
                </div>
            </div>
            <div style="background:#F9FAFB; padding:20px; border-radius:20px; margin-bottom:20px;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                    <div style="font-size:0.8rem; color:#aaa; font-weight:bold;">常用组词</div>
                    <div class="read-btn" style="margin-left:0; width:32px; height:32px; font-size:1rem;"
                        onclick="AudioSys.speak(document.getElementById('card-words').innerText)">🔊</div>
                </div>
                <div id="card-words" style="color:#333; line-height:1.6; font-size:1.1rem;"></div>
                <div style="font-size:0.8rem; color:#aaa; font-weight:bold; margin-top:15px; margin-bottom:5px;">意思
                </div>
                <div id="card-desc" style="color:#555; line-height:1.5; font-size:0.95rem;"></div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeOverlay('detail-modal')">关闭</button>
                <button id="mistake-action-btn" class="btn-main" onclick="MistakeBook.resolveCurrent()">我记住了</button>
            </div>
        </div>
    </div>

    <!-- 弹窗：复习小关卡 -->
    <div id="review-quiz-modal" class="modal-overlay">
        <div class="card review-quiz-card">
            <div class="close-btn" onclick="MiniQuiz.close(true)">✕</div>
            <h2 style="text-align:center; color:#333; margin-bottom:6px;">复习挑战</h2>
            <div class="review-quiz-sub">8 秒内选出正确拼音</div>
            <div class="review-timer">⏱️ <span id="review-timer">8.0</span>s</div>
            <div class="review-arena">
                <div id="review-char" class="review-char">字</div>
                <button class="review-option pos-top" id="review-opt-top">?</button>
                <button class="review-option pos-right" id="review-opt-right">?</button>
                <button class="review-option pos-bottom" id="review-opt-bottom">?</button>
                <button class="review-option pos-left" id="review-opt-left">?</button>
            </div>
            <div class="review-tip">点一下拼音即可答题</div>
        </div>
    </div>

    <!-- 弹窗：重玩确认 -->
    <div id="confirm-modal" class="modal-overlay">
        <div class="card" style="text-align:center;">
            <div class="close-btn" onclick="closeOverlay('confirm-modal')">✕</div>
            <h3>重新挑战？</h3>
            <p style="color:#666; margin:15px 0;">你已经通过这一关啦，想要再玩一次刷新纪录吗？</p>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeOverlay('confirm-modal')">取消</button>
                <button class="btn-main" onclick="Game.confirmReplay()">确定挑战</button>
            </div>
        </div>
    </div>

    <!-- 弹窗：昵称设置 -->
    <div id="nickname-modal" class="modal-overlay">
        <div class="card" style="text-align:center; max-width:480px;">
            <div class="close-btn" id="nickname-close" onclick="closeOverlay('nickname-modal')" style="display:none">✕
            </div>
            <div style="font-size:4rem; margin-bottom:15px;">👋</div>
            <h2 style="color:#333; margin-bottom:10px;">欢迎来到识字大冒险！</h2>
            <p style="color:#666; margin-bottom:25px; line-height:1.6;">小朋友，请告诉我你的昵称吧～</p>
            <div style="background:#F9FAFB; padding:20px; border-radius:20px; margin-bottom:25px;">
                <input type="text" id="nickname-input" placeholder="输入你的昵称" maxlength="4"
                    style="width:100%; padding:15px; border:2px solid #E5E7EB; border-radius:15px; font-size:1.1rem; text-align:center; outline:none; font-family:'KaiTi', sans-serif;"
                    onkeypress="if(event.key==='Enter') NicknameSystem.save()">
                <div style="margin-top:15px; color:#999; font-size:0.85rem;">💡 最多4个字哦</div>
            </div>
            <button class="btn-sec" onclick="NicknameSystem.randomNickname()" style="width:100%; margin-bottom:12px;">
                🎲 随机生成可爱昵称
            </button>
            <button class="btn-main" id="nickname-save-btn" onclick="NicknameSystem.save()" style="width:100%;">
                ✨ 开始冒险
            </button>
        </div>
    </div>

    <!-- 弹窗：年级选择 -->
    <div id="grade-modal" class="modal-overlay">
        <div class="card" style="max-width:420px;">
            <div class="close-btn" onclick="GradeSelector.close()">✕</div>
            <h2 style="text-align:center; color:#333; margin-bottom:18px;">选择年级</h2>
            <div id="grade-list" class="grade-list"></div>
            <div class="grade-tip">切换年级后，将加载对应的学习进度。</div>
            <div class="grade-current">当前年级：<span id="grade-current-name">二年级（下）</span></div>
        </div>
    </div>

    <!-- 弹窗：盲盒大奖 -->
    <div id="reward-modal" class="modal-overlay">
        <div class="card"
            style="text-align:center; background: linear-gradient(135deg, #fff9c4 0%, #fff 100%); border: 3px solid #ffcc33;">
            <div style="font-size:5rem; margin-bottom:15px; animation: bubble-pop 0.5s infinite alternate;">🏆</div>
            <h2 style="color: #f59e0b; margin-bottom:10px;">超级盲盒大奖！</h2>
            <p style="color:#666; margin-bottom:20px; line-height:1.6;">太厉害了！你完成了今日全部的盲盒挑战！<br>作为奖励，你获得了 <b>200</b> 点能量和
                <b>100</b> 枚金币！
            </p>
            <div style="font-size:2rem; margin-bottom:20px;">💰 ✨ 💎</div>
            <button class="btn-main" onclick="closeOverlay('reward-modal')"
                style="width:100%; background:#f59e0b;">收下奖励</button>
        </div>
    </div>

    <!-- 弹窗：今日必练奖励 -->
    <div id="daily-reward-modal" class="modal-overlay">
        <div class="card daily-reward-card">
            <div style="font-size:4rem; margin-bottom:10px;">🎉</div>
            <h2 style="color:#333; margin-bottom:6px;">今日必练完成！</h2>
            <div style="color:#666; margin-bottom:16px;">太棒啦，奖励你一颗星星！</div>
            <div class="daily-reward-stars">⭐ 🌟 ⭐</div>
            <button class="btn-main" onclick="closeOverlay('daily-reward-modal')">收下奖励</button>
        </div>
    </div>

    <!-- 弹窗：胜利 -->
    <div id="win-modal" class="modal-overlay">
        <div class="card" style="text-align:center;">
            <div style="font-size:4rem; margin-bottom:10px;">🎉</div>
            <h2 style="color:#333; margin-bottom:5px;">挑战成功</h2>
            <div id="encouragement-text"
                style="color:#FF6B9D; font-weight:bold; font-size:1rem; margin:10px 0; min-height:24px;"></div>
            <div id="record-alert"
                style="display:none; color:#F59E0B; font-weight:bold; font-size:0.9rem; margin-bottom:10px;">👑
                打破最快纪录！
            </div>
            <div id="star-rating" style="font-size:2rem; color:#FFD93D; letter-spacing:5px; margin-bottom:20px;">⭐⭐⭐
            </div>
            <div
                style="display:flex; justify-content:space-around; background:#F9FAFB; padding:15px; border-radius:15px; margin-bottom:25px;">
                <div>
                    <div style="font-size:0.8rem; color:#aaa;">耗时</div>
                    <div style="font-weight:900; font-family:'Nunito'; font-size:1.2rem;" id="result-time">0s</div>
                </div>
                <div style="width:1px; background:#ddd;"></div>
                <div>
                    <div style="font-size:0.8rem; color:#aaa;">最佳</div>
                    <div style="font-weight:900; font-family:'Nunito'; font-size:1.2rem;" id="result-best">-</div>
                </div>
            </div>
            <div class="btn-group">
                <button class="btn-sec" onclick="Game.replayLevel()">↺ 重玩</button>
                <button class="btn-main" onclick="Game.nextLevel()">下一关</button>
            </div>
            <div style="margin-top:20px; color:#aaa; cursor:pointer;" onclick="Game.showLevelMap()">返回地图</div>
        </div>
    </div>

    <!-- 弹窗：拼音雨成功 -->
    <div id="pinyin-rain-win-modal" class="modal-overlay">
        <div class="card" style="text-align:center;">
            <div style="font-size:4rem; margin-bottom:10px;">🌟</div>
            <h2 style="color:#333; margin-bottom:6px;">拼音雨通关</h2>
            <div style="color:#666; margin-bottom:20px;">节奏太稳了！</div>
            <div class="btn-group">
                <button class="btn-sec" onclick="Game.replayPinyinRain()">再来一局</button>
                <button class="btn-main" onclick="Game.exitPinyinRainToMap()">返回地图</button>
            </div>
        </div>
    </div>

    <!-- 弹窗：拼音雨失败 -->
    <div id="pinyin-rain-fail-modal" class="modal-overlay">
        <div class="card" style="text-align:center;">
            <div style="font-size:4rem; margin-bottom:10px;">💥</div>
            <h2 style="color:#333; margin-bottom:6px;">闯关失败</h2>
            <div style="color:#666; margin-bottom:20px;">差一点点，继续加油！</div>
            <div class="btn-group">
                <button class="btn-sec" onclick="Game.replayPinyinRain()">再试一次</button>
                <button class="btn-main" onclick="Game.exitPinyinRainToMap()">返回地图</button>
            </div>
        </div>
    </div>

    <!-- 弹窗：Boss 警告 -->
    <div id="boss-warning-modal" class="modal-overlay" style="z-index: 300; background: rgba(0,0,0,0.9);">
        <div class="card" style="text-align:center; border: 4px solid #FF4757; background: #FFF;">
            <div style="font-size:5rem; margin-bottom:10px;">👹</div>
            <h2 style="color:#FF4757; font-size: 2.5rem; margin-bottom:10px; font-family:'KaiTi';">大魔王出现！</h2>
            <p style="color:#333; font-size:1.2rem; margin-bottom:20px;">
                必须在 <span style="color:#FF4757; font-weight:bold; font-size:1.4rem;">13秒</span> 内击败它！
            </p>
            <div
                style="background:#FFF0F0; padding:15px; border-radius:10px; color:#c0392b; margin-bottom:25px; font-size:0.9rem;">
                ⚠️ 包含你容易做错的字哦！
            </div>
            <button class="btn-main" style="background:#FF4757; width:100%; font-size:1.3rem; padding:15px;"
                onclick="closeOverlay('boss-warning-modal'); Game.startBossLevel()">
                ⚔️ 接受挑战
            </button>
        </div>
    </div>

    <!-- 弹窗：Boss 失败 -->
    <div id="boss-fail-modal" class="modal-overlay" style="z-index: 300;">
        <div class="card" style="text-align:center;">
            <div style="font-size:4rem; margin-bottom:10px;">💔</div>
            <h2 style="color:#333; margin-bottom:10px;">时间到！</h2>
            <p style="color:#666; margin-bottom:20px;">大魔王太强了，不要灰心！</p>
            <button class="btn-main" onclick="closeOverlay('boss-fail-modal'); Game.startBossLevel()">🔄 重新挑战</button>
            <div style="margin-top:15px; color:#aaa; cursor:pointer;"
                onclick="closeOverlay('boss-fail-modal'); HomeDashboard.show()">暂时撤退</div>
        </div>
    </div>

    <!-- ES Modules 入口 -->
    <script type="module" src="js/main.js"></script>
</body>

</html>